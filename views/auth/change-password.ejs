<!-- Change Password Form -->
<div class="text-center mb-8">
    <h1 class="text-2xl font-bold text-gray-800">Change Password</h1>
    <p class="text-gray-600 mt-2">Please enter your current password and choose a new one</p>
</div>

<form action="/auth/change-password" method="POST" class="space-y-6" id="changePasswordForm">
    <!-- Current Password -->
    <div>
        <label for="currentPassword" class="block text-sm font-medium text-gray-700">Current Password</label>
        <div class="mt-1">
            <input 
                type="password" 
                name="currentPassword" 
                id="currentPassword" 
                required 
                class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary"
                placeholder="Enter your current password"
            >
        </div>
    </div>

    <!-- New Password -->
    <div>
        <label for="newPassword" class="block text-sm font-medium text-gray-700">New Password</label>
        <div class="mt-1">
            <input 
                type="password" 
                name="newPassword" 
                id="newPassword" 
                required 
                minlength="8"
                class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary"
                placeholder="Enter your new password"
            >
        </div>
        <p class="mt-2 text-sm text-gray-500">
            Password must be at least 8 characters long and include uppercase, lowercase, numbers, and special characters.
        </p>
    </div>

    <!-- Confirm New Password -->
    <div>
        <label for="confirmPassword" class="block text-sm font-medium text-gray-700">Confirm New Password</label>
        <div class="mt-1">
            <input 
                type="password" 
                name="confirmPassword" 
                id="confirmPassword" 
                required 
                class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary"
                placeholder="Confirm your new password"
            >
        </div>
    </div>

    <!-- Password Requirements -->
    <div class="bg-gray-50 p-4 rounded-md">
        <h3 class="text-sm font-medium text-gray-700 mb-2">Password Requirements:</h3>
        <ul class="text-sm text-gray-600 space-y-1">
            <li id="lengthCheck" class="flex items-center">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
                At least 8 characters long
            </li>
            <li id="uppercaseCheck" class="flex items-center">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
                Contains uppercase letter
            </li>
            <li id="lowercaseCheck" class="flex items-center">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
                Contains lowercase letter
            </li>
            <li id="numberCheck" class="flex items-center">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
                Contains number
            </li>
            <li id="specialCheck" class="flex items-center">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
                Contains special character
            </li>
            <li id="matchCheck" class="flex items-center">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
                Passwords match
            </li>
        </ul>
    </div>

    <!-- Submit Button -->
    <div>
        <button 
            type="submit" 
            class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
            id="submitButton"
            disabled
        >
            Change Password
        </button>
    </div>
</form>

<script>
    const form = document.getElementById('changePasswordForm');
    const newPassword = document.getElementById('newPassword');
    const confirmPassword = document.getElementById('confirmPassword');
    const submitButton = document.getElementById('submitButton');

    // Requirements check elements
    const lengthCheck = document.getElementById('lengthCheck');
    const uppercaseCheck = document.getElementById('uppercaseCheck');
    const lowercaseCheck = document.getElementById('lowercaseCheck');
    const numberCheck = document.getElementById('numberCheck');
    const specialCheck = document.getElementById('specialCheck');
    const matchCheck = document.getElementById('matchCheck');

    function updateRequirements() {
        const password = newPassword.value;
        const confirm = confirmPassword.value;

        // Check length
        if (password.length >= 8) {
            lengthCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
            lengthCheck.classList.remove('text-gray-600');
            lengthCheck.classList.add('text-green-600');
        } else {
            lengthCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
            lengthCheck.classList.remove('text-green-600');
            lengthCheck.classList.add('text-gray-600');
        }

        // Check uppercase
        if (/[A-Z]/.test(password)) {
            uppercaseCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
            uppercaseCheck.classList.remove('text-gray-600');
            uppercaseCheck.classList.add('text-green-600');
        } else {
            uppercaseCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
            uppercaseCheck.classList.remove('text-green-600');
            uppercaseCheck.classList.add('text-gray-600');
        }

        // Check lowercase
        if (/[a-z]/.test(password)) {
            lowercaseCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
            lowercaseCheck.classList.remove('text-gray-600');
            lowercaseCheck.classList.add('text-green-600');
        } else {
            lowercaseCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
            lowercaseCheck.classList.remove('text-green-600');
            lowercaseCheck.classList.add('text-gray-600');
        }

        // Check number
        if (/[0-9]/.test(password)) {
            numberCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
            numberCheck.classList.remove('text-gray-600');
            numberCheck.classList.add('text-green-600');
        } else {
            numberCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
            numberCheck.classList.remove('text-green-600');
            numberCheck.classList.add('text-gray-600');
        }

        // Check special character
        if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
            specialCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
            specialCheck.classList.remove('text-gray-600');
            specialCheck.classList.add('text-green-600');
        } else {
            specialCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
            specialCheck.classList.remove('text-green-600');
            specialCheck.classList.add('text-gray-600');
        }

        // Check passwords match
        if (password && confirm && password === confirm) {
            matchCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
            matchCheck.classList.remove('text-gray-600');
            matchCheck.classList.add('text-green-600');
        } else {
            matchCheck.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
            matchCheck.classList.remove('text-green-600');
            matchCheck.classList.add('text-gray-600');
        }

        // Enable/disable submit button
        const allRequirementsMet = 
            password.length >= 8 &&
            /[A-Z]/.test(password) &&
            /[a-z]/.test(password) &&
            /[0-9]/.test(password) &&
            /[!@#$%^&*(),.?":{}|<>]/.test(password) &&
            password === confirm;

        submitButton.disabled = !allRequirementsMet;
        if (allRequirementsMet) {
            submitButton.classList.remove('bg-gray-400');
            submitButton.classList.add('bg-primary');
        } else {
            submitButton.classList.remove('bg-primary');
            submitButton.classList.add('bg-gray-400');
        }
    }

    newPassword.addEventListener('input', updateRequirements);
    confirmPassword.addEventListener('input', updateRequirements);

    form.addEventListener('submit', (e) => {
        if (!submitButton.disabled) {
            return true;
        }
        e.preventDefault();
        return false;
    });
</script> 